!function i(a,c,d){function u(t,e){if(!c[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var r=c[t]={exports:{}};a[t][0].call(r.exports,function(e){return u(a[t][1][e]||e)},r,r.exports,i,a,c,d)}return c[t].exports}for(var l="function"==typeof require&&require,e=0;e<d.length;e++)u(d[e]);return u}({1:[function(e,t,n){"use strict";t.exports=e("./recorder-identify").RIdentify},{"./recorder-identify":2}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var o=n.RIdentify=function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.recorderConfig={numChannels:1,mimeType:"audio/wav",bitRate:16,sampleRate:16e3};var r=this;Object.assign(this.recorderConfig,t.config);var i=t.url||"/robot/rs/qa/asr",n=1e3*(t.time||21),a=0,c=null,o=null,d=!1;(function(){var e=Recorder({type:r.recorderConfig.mimeType.split("/")[1],bitRate:r.recorderConfig.bitRate,sampleRate:r.recorderConfig.sampleRate,disableEnvInFix:!0,onProcess:function(){}});e.open(function(){o=e},function(e,t){p((t?"UserNotAllow，":"")+"打开录音失败："+e)})})(),document.getElementById("rIdentify").addEventListener("mousedown",function(){void 0!==d?function(){u&&(clearInterval(u),u=null);o&&Recorder.IsOpen()?(o.start(),setTimeout(function(){p(l+".")},200),u=setInterval(function(){p(l+=".")},800),d=!d,a=new Date,c=setInterval(function(){a&&(new Date).getTime()-a.getTime()>=n&&s()},n)):p("未打开录音")}():p("请确认麦克风未被禁用！")}),document.getElementById("rIdentify").addEventListener("mouseup",function(){void 0!==d?s():p("请确认麦克风未被禁用！")}),document.getElementById(document.getElementById("rIdentify").getAttribute("data-search-id")).addEventListener("change",function(e){console.log("change事件：",e.target.value)});var u=null,l="";function s(){clearInterval(u),u=null,l="",o&&o.stop(function(e,t){var n,o;(d=!d,clearInterval(c),a&&(new Date).getTime()-a.getTime()<1e3)?a=0:(a=0,e.size<2e4?p("录音太短不可用！"):(n=e,(o=new FormData).append("file",n,(new Date).getTime()+"."+r.recorderConfig.mimeType.split("/")[1]),function(e){(e=e||{}).type=e.type.toUpperCase()||"GET",e.url=e.url||"",e.async=e.async||!0,e.data=e.data||null,e.success=e.success||function(){},e.error=e.error||function(e){console.log(e)};var t=null;t=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.xhr");if(t.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=(e.loaded/e.total*100).toFixed(0);console.log("上传进度：",t,"%")}},!1),t.addEventListener("readystatechange",function(){4==t.readyState&&200==t.status&&e.success(t.response)}),"POST"===e.type.toUpperCase())t.open(e.type,e.url,e.async),t.send(e.data);else if("GET"===e.type.toUpperCase()){var n=[];for(var o in e.data)n.push(o+"="+e.data[o]);var r=n.join("&");t.open(e.type,e.url+"?"+r,e.async),t.send(null)}}({url:i,type:"post",data:o,processData:!1,contentType:!1,success:function(e){if((e=JSON.parse(e)).data){var t=document.getElementById("rIdentify").getAttribute("data-search-id");t&&(document.getElementById(t).value=e.data,function(e,t){if("object"==(void 0===e?"undefined":m(e)))if(t=t.replace(/^on/i,""),document.all)t="on"+t,e.triggerEvent(t);else{var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}}(document.getElementById(t),"change"))}},error:function(e){console.log(e)}})))},function(e){p("录音失败:"+e)})}var f=null;function p(e){var t=document.getElementById("rIdentifyTip");t&&(t.parentNode.removeChild(t),f&&clearTimeout(f)),(t=document.createElement("div")).id="rIdentifyTip",t.style.cssText="position: fixed; top: "+(document.getElementById("rIdentify").getBoundingClientRect().top-20)+"px;left: "+document.getElementById("rIdentify").getBoundingClientRect().left+"px;border-radius: 8px;margin-top: -15px;color: #fff;background-color: #409eff;padding: 5px 0;z-index: 2147483647;";var n=document.createElement("span");n.innerText=e,n.style.cssText="margin: 0 10px;white-space: nowrap;",t.appendChild(n),document.getElementById("rIdentify").parentNode.appendChild(t),f=setTimeout(function(){(t=document.getElementById("rIdentifyTip")).parentNode.removeChild(t)},1e3)}};new(n.default=o)},{}]},{},[1]);